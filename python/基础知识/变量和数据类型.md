# Python变量和数据类型

Python是一种动态类型语言，拥有丰富的内置数据类型。本文档介绍Python的变量系统和基本数据类型，帮助你理解Python程序的基础构建块。

## 变量

### 变量的定义与赋值

在Python中，变量是用于存储数据的命名引用。Python中的变量不需要显式声明类型，解释器会根据赋值自动确定类型。

```python
# 变量赋值
name = "Python"
age = 30
pi = 3.14159
is_active = True

# 多重赋值
x, y, z = 1, 2, 3

# 相同值赋给多个变量
a = b = c = 0
```

### 变量命名规则

Python变量名必须遵循以下规则：

1. 只能包含字母、数字和下划线（A-z、0-9和_）
2. 必须以字母或下划线开头
3. 区分大小写（`name`和`Name`是不同的变量）
4. 不能使用Python关键字（如`if`、`for`、`class`等）

```python
# 有效的变量名
user_name = "Alice"
_hidden = "Hidden variable"
count123 = 123
camelCase = "camel case naming"
snake_case = "snake case naming"  # Python推荐的命名风格

# 无效的变量名
# 2ndPlace = "Silver"  # 不能以数字开头
# my-variable = "Hello"  # 不能包含连字符
# class = "Python class"  # 不能使用关键字
```

### Python的命名约定

虽然Python不强制特定的命名风格，但PEP 8（Python风格指南）推荐以下约定：

- 使用小写字母和下划线命名变量和函数（`snake_case`）
- 使用大写字母和下划线命名常量（`UPPER_CASE`）
- 使用首字母大写命名类（`PascalCase`）
- 使用下划线开头命名私有变量或方法（`_private_var`）
- 使用双下划线开头命名强私有变量或方法（`__very_private`）

```python
# 遵循命名约定的示例
user_name = "Alice"  # 变量
MAX_SIZE = 100  # 常量
class UserProfile:  # 类
    pass
_internal_data = "Internal"  # 私有变量
```

### 变量的作用域

Python中的变量有四种作用域：

1. **局部作用域（Local）**：在函数内部定义的变量
2. **闭包作用域（Enclosing）**：在外层函数中定义的变量
3. **全局作用域（Global）**：在模块级别定义的变量
4. **内置作用域（Built-in）**：Python预定义的名称

Python按照LEGB规则（Local, Enclosing, Global, Built-in）搜索变量名。

```python
x = "global x"  # 全局变量

def outer_function():
    y = "outer y"  # 闭包变量
    
    def inner_function():
        z = "inner z"  # 局部变量
        print(x)  # 访问全局变量
        print(y)  # 访问闭包变量
        print(z)  # 访问局部变量
    
    inner_function()

outer_function()
```

使用`global`和`nonlocal`关键字可以修改不同作用域的变量：

```python
x = 10

def modify_global():
    global x
    x = 20

def outer():
    y = 10
    
    def inner():
        nonlocal y
        y = 20
    
    inner()
    print(y)  # 输出20

modify_global()
print(x)  # 输出20
outer()
```

## 数据类型

Python有几种内置的数据类型，可以分为以下几类：

### 数字类型

#### 整数 (int)

整数是没有小数部分的数字，可以是正数、负数或零。Python整数没有大小限制。

```python
a = 10
b = -5
c = 0
big_number = 10**100  # 10的100次方

# 不同进制表示
decimal = 42
binary = 0b101010  # 二进制，等于42
octal = 0o52      # 八进制，等于42
hexadecimal = 0x2A  # 十六进制，等于42
```

#### 浮点数 (float)

浮点数是带有小数部分的数字。

```python
pi = 3.14159
e = 2.71828
negative_float = -0.5

# 科学计数法
avogadro = 6.022e23  # 6.022 × 10^23
plank = 6.626e-34    # 6.626 × 10^-34
```

#### 复数 (complex)

复数由实部和虚部组成，表示为`a + bj`。

```python
z = 3 + 4j
print(z.real)  # 3.0，实部
print(z.imag)  # 4.0，虚部
print(abs(z))  # 5.0，绝对值（模）
```

### 序列类型

#### 字符串 (str)

字符串是由单引号、双引号或三引号括起来的一系列字符。

```python
# 字符串创建
single_quoted = 'Hello'
double_quoted = "World"
triple_quoted = '''This is a
multiline string'''

# 字符串连接
greeting = single_quoted + " " + double_quoted  # "Hello World"

# 字符串重复
repeated = "Python " * 3  # "Python Python Python "

# 字符串索引
first_char = greeting[0]  # "H"
last_char = greeting[-1]  # "d"

# 字符串切片
substring = greeting[0:5]  # "Hello"

# 字符串方法
upper_case = greeting.upper()  # "HELLO WORLD"
replaced = greeting.replace("World", "Python")  # "Hello Python"
split_string = greeting.split(" ")  # ["Hello", "World"]

# 字符串格式化
name = "Alice"
formatted_string = f"Hello, {name}!"  # "Hello, Alice!"
template = "Hello, {}!"
formatted_template = template.format(name)  # "Hello, Alice!"
```

#### 列表 (list)

列表是一个有序、可变的序列，可以包含不同类型的元素。

```python
# 列表创建
empty_list = []
numbers = [1, 2, 3, 4, 5]
mixed = [1, "Hello", 3.14, True]

# 嵌套列表
matrix = [[1, 2, 3], [4, 5, 6], [7, 8, 9]]

# 列表索引
first_item = numbers[0]  # 1
last_item = numbers[-1]  # 5

# 列表切片
subset = numbers[1:4]  # [2, 3, 4]

# 列表修改
numbers[0] = 10  # [10, 2, 3, 4, 5]

# 列表操作
numbers.append(6)  # [10, 2, 3, 4, 5, 6]
numbers.insert(1, 15)  # [10, 15, 2, 3, 4, 5, 6]
numbers.remove(3)  # [10, 15, 2, 4, 5, 6]
popped = numbers.pop()  # 6，numbers变为[10, 15, 2, 4, 5]
numbers.extend([7, 8])  # [10, 15, 2, 4, 5, 7, 8]
numbers.sort()  # [2, 4, 5, 7, 8, 10, 15]
numbers.reverse()  # [15, 10, 8, 7, 5, 4, 2]

# 列表推导式
squares = [x**2 for x in range(10)]  # [0, 1, 4, 9, 16, 25, 36, 49, 64, 81]
```

#### 元组 (tuple)

元组是一个有序、不可变的序列，可以包含不同类型的元素。

```python
# 元组创建
empty_tuple = ()
single_item = (1,)  # 注意单元素元组需要逗号
coordinates = (3, 4)
mixed_tuple = (1, "Hello", 3.14)

# 元组解包
x, y = coordinates  # x=3, y=4

# 元组的不可变性
# coordinates[0] = 5  # 这会引发TypeError

# 元组操作
combined = coordinates + (5, 6)  # (3, 4, 5, 6)
repeated = coordinates * 3  # (3, 4, 3, 4, 3, 4)
```

### 映射类型

#### 字典 (dict)

字典是一个无序的键值对集合，键必须是唯一且不可变的（通常是字符串）。

```python
# 字典创建
empty_dict = {}
person = {"name": "Alice", "age": 30, "city": "New York"}
using_dict = dict(name="Bob", age=25, city="Boston")

# 访问字典元素
name = person["name"]  # "Alice"
# 使用get方法可以提供默认值
age = person.get("age", 0)  # 30
country = person.get("country", "Unknown")  # "Unknown"

# 修改字典
person["age"] = 31
person["country"] = "USA"
person.update({"email": "alice@example.com", "phone": "555-1234"})

# 删除字典元素
del person["phone"]
email = person.pop("email")  # 移除并返回值
last_item = person.popitem()  # 移除并返回最后添加的键值对

# 字典操作
keys = list(person.keys())
values = list(person.values())
items = list(person.items())  # 键值对元组的列表

# 字典推导式
squares_dict = {x: x**2 for x in range(6)}  # {0: 0, 1: 1, 2: 4, 3: 9, 4: 16, 5: 25}
```

### 集合类型

#### 集合 (set)

集合是一个无序、不重复元素的集合。

```python
# 集合创建
empty_set = set()  # 注意：{}创建的是空字典，不是空集合
fruits = {"apple", "banana", "cherry"}
numbers = set([1, 2, 3, 2, 1])  # {1, 2, 3}，自动去重

# 集合操作
fruits.add("orange")
fruits.remove("banana")  # 如果元素不存在，会引发KeyError
fruits.discard("melon")  # 不存在也不会引发错误
popped = fruits.pop()  # 随机移除并返回一个元素

# 集合运算
set1 = {1, 2, 3, 4, 5}
set2 = {4, 5, 6, 7, 8}

union = set1 | set2  # 并集：{1, 2, 3, 4, 5, 6, 7, 8}
intersection = set1 & set2  # 交集：{4, 5}
difference = set1 - set2  # 差集：{1, 2, 3}
symmetric_diff = set1 ^ set2  # 对称差集：{1, 2, 3, 6, 7, 8}

# 集合推导式
even_numbers = {x for x in range(10) if x % 2 == 0}  # {0, 2, 4, 6, 8}
```

#### 不可变集合 (frozenset)

不可变集合是不可修改的集合，可以用作字典的键或其他集合的元素。

```python
# 创建不可变集合
frozen = frozenset([1, 2, 3, 4, 5])

# 不可修改
# frozen.add(6)  # 这会引发AttributeError

# 可以进行集合运算，但返回一个新的不可变集合
union = frozen | {6, 7, 8}  # frozenset({1, 2, 3, 4, 5, 6, 7, 8})
```

### 布尔类型 (bool)

布尔类型只有两个值：`True`和`False`。

```python
is_valid = True
has_error = False

# 布尔运算
result1 = True and False  # False
result2 = True or False  # True
result3 = not True  # False

# 比较运算产生布尔值
is_equal = (5 == 5)  # True
is_greater = (10 > 5)  # True
is_less = (3 < 2)  # False
```

### None类型

`None`是一个特殊的常量，表示缺少值或空值。

```python
result = None

# 检查None
is_none = result is None  # True

# 函数默认返回None
def do_nothing():
    pass

print(do_nothing() is None)  # True
```

## 类型转换

Python提供了多种内置函数用于类型转换：

```python
# 转换为整数
int_from_str = int("42")  # 42
int_from_float = int(3.14)  # 3（截断小数部分）
int_from_bool = int(True)  # 1

# 转换为浮点数
float_from_str = float("3.14")  # 3.14
float_from_int = float(42)  # 42.0

# 转换为字符串
str_from_int = str(42)  # "42"
str_from_float = str(3.14)  # "3.14"
str_from_bool = str(True)  # "True"

# 转换为布尔值
bool_from_int = bool(0)  # False（0被视为False，其他数字为True）
bool_from_str = bool("")  # False（空字符串被视为False）
bool_from_list = bool([])  # False（空列表被视为False）

# 转换为列表
list_from_str = list("Python")  # ['P', 'y', 't', 'h', 'o', 'n']
list_from_tuple = list((1, 2, 3))  # [1, 2, 3]
list_from_set = list({1, 2, 3})  # [1, 2, 3]

# 转换为元组
tuple_from_list = tuple([1, 2, 3])  # (1, 2, 3)
tuple_from_str = tuple("Python")  # ('P', 'y', 't', 'h', 'o', 'n')

# 转换为集合
set_from_list = set([1, 2, 2, 3])  # {1, 2, 3}
set_from_str = set("Mississippi")  # {'M', 'i', 's', 'p'}

# 转换为字典
dict_from_tuples = dict([("a", 1), ("b", 2)])  # {'a': 1, 'b': 2}
```

## 类型检查

Python提供了多种方式来检查变量的类型：

```python
# 使用type()函数
x = 42
print(type(x))  # <class 'int'>
print(type(x) is int)  # True

# 使用isinstance()函数（推荐）
print(isinstance(x, int))  # True
print(isinstance(x, (int, float)))  # True，检查多种类型

# 检查集合类型
print(isinstance([1, 2, 3], list))  # True
print(isinstance((1, 2, 3), tuple))  # True
print(isinstance({1, 2, 3}, set))  # True
print(isinstance({"a": 1, "b": 2}, dict))  # True
```

## 变量的内存管理

Python使用引用计数和垃圾回收机制管理内存。

```python
import sys

# 查看对象的引用计数
x = "Hello"
y = x
print(sys.getrefcount(x) - 1)  # 输出2（减1是因为getrefcount本身也会创建一个引用）

# id()函数返回对象的内存地址
print(id(x))
print(id(y))  # 与x相同，因为它们引用同一对象

# is运算符检查两个变量是否引用同一对象
print(x is y)  # True

# 不可变对象
a = "hello"
b = "hello"
print(a is b)  # 通常为True，因为Python会对字符串和小整数进行内部缓存

# 可变对象的行为
list1 = [1, 2, 3]
list2 = [1, 2, 3]
print(list1 is list2)  # False，尽管内容相同，但是不同对象

# 对象相等性vs身份
print(list1 == list2)  # True，内容相等
print(list1 is list2)  # False，不是同一对象
```

## 数据类型的可变性

Python数据类型可以分为可变（mutable）和不可变（immutable）：

### 不可变类型

- 整数（int）
- 浮点数（float）
- 复数（complex）
- 字符串（str）
- 元组（tuple）
- 不可变集合（frozenset）
- 布尔值（bool）
- None

```python
# 字符串是不可变的
s = "hello"
# s[0] = "H"  # 这会引发TypeError

# 创建一个新字符串
s = "H" + s[1:]  # "Hello"
```

### 可变类型

- 列表（list）
- 字典（dict）
- 集合（set）

```python
# 列表是可变的
my_list = [1, 2, 3]
my_list[0] = 10  # [10, 2, 3]
my_list.append(4)  # [10, 2, 3, 4]

# 字典是可变的
my_dict = {"a": 1}
my_dict["b"] = 2  # {"a": 1, "b": 2}

# 集合是可变的
my_set = {1, 2, 3}
my_set.add(4)  # {1, 2, 3, 4}
```

## 深拷贝与浅拷贝

当处理嵌套的可变对象时，了解深拷贝和浅拷贝的区别很重要：

```python
import copy

# 原始对象
original = [[1, 2, 3], [4, 5, 6]]

# 赋值（引用相同对象）
reference = original
reference[0][0] = 10  # 同时修改original

# 浅拷贝（复制外层容器，但内部元素是引用）
shallow = copy.copy(original)
shallow[0][0] = 20  # 修改original
shallow[0] = [30, 40, 50]  # 不修改original

# 深拷贝（递归复制所有内容）
deep = copy.deepcopy(original)
deep[0][0] = 100  # 不修改original
```

## 高级类型标注（Python 3.5+）

Python 3.5引入了类型标注系统，虽然Python仍然是动态类型的，但标注可以提高代码可读性并支持静态类型检查工具：

```python
from typing import List, Dict, Tuple, Set, Optional, Union, Any, Callable

# 基本类型标注
def greet(name: str) -> str:
    return f"Hello, {name}"

# 容器类型标注
def process_numbers(numbers: List[int]) -> List[int]:
    return [n * 2 for n in numbers]

# 复杂类型标注
def update_user(user_id: int, 
                data: Dict[str, Any], 
                tags: Optional[List[str]] = None) -> bool:
    # 函数实现...
    return True

# 联合类型
def normalize(value: Union[int, float, str]) -> float:
    if isinstance(value, str):
        return float(value.strip())
    return float(value)

# 函数类型
def apply_operation(x: int, operation: Callable[[int], int]) -> int:
    return operation(x)

# 类型别名
Vector = List[float]

def scale(vector: Vector, factor: float) -> Vector:
    return [x * factor for x in vector]
```

## Python数据类型的应用场景

以下是不同数据类型的常见应用场景：

- **整数**：计数、索引、算术运算
- **浮点数**：科学计算、精度要求不高的金融计算
- **复数**：信号处理、物理和工程计算
- **字符串**：文本处理、数据解析、用户输入/输出
- **列表**：有序集合、序列处理、可变数据集
- **元组**：不可变数据集、函数返回多个值、字典键
- **字典**：键值对、快速查找、数据映射、JSON处理
- **集合**：去重、成员测试、数学集合运算
- **布尔值**：条件测试、标志位、逻辑控制
- **None**：表示缺少值、函数默认返回值、初始化

通过深入理解Python的变量系统和数据类型，你可以更有效地组织和操作数据，写出更简洁、高效的Python代码。不同的数据类型有各自的优势和适用场景，选择合适的数据类型对于解决特定问题至关重要。
