# Python控制流

控制流语句允许程序根据条件执行不同的代码块，或者重复执行代码块。Python提供了丰富的控制流结构，使得代码能够灵活应对各种情况。

## 条件语句

### if语句

`if`语句用于根据条件执行代码块：

```python
age = 20

if age >= 18:
    print("您已成年")
```

### if-else语句

`if-else`语句提供了两个分支的选择：

```python
age = 16

if age >= 18:
    print("您已成年")
else:
    print("您未成年")
```

### if-elif-else语句

`if-elif-else`结构用于处理多个条件分支：

```python
score = 85

if score >= 90:
    grade = "A"
elif score >= 80:
    grade = "B"
elif score >= 70:
    grade = "C"
elif score >= 60:
    grade = "D"
else:
    grade = "F"

print(f"您的成绩等级是：{grade}")
```

### 嵌套条件语句

条件语句可以嵌套使用：

```python
age = 20
has_id = True

if age >= 18:
    if has_id:
        print("您可以进入")
    else:
        print("请出示您的身份证")
else:
    print("您未成年，不能进入")
```

### 条件表达式（三元运算符）

Python提供了简洁的条件表达式（也称为三元运算符）：

```python
age = 20
status = "成年" if age >= 18 else "未成年"
print(status)  # 输出: 成年
```

## 循环语句

### for循环

`for`循环用于遍历任何可迭代对象（如列表、元组、字符串等）：

```python
# 遍历列表
fruits = ["苹果", "香蕉", "橙子"]
for fruit in fruits:
    print(fruit)

# 遍历字符串
for char in "Python":
    print(char)

# 使用range()遍历数字序列
for i in range(5):  # 0, 1, 2, 3, 4
    print(i)

# 带起始值和步长的range
for i in range(2, 10, 2):  # 2, 4, 6, 8
    print(i)
```

### while循环

`while`循环在条件为真时重复执行代码块：

```python
count = 0
while count < 5:
    print(count)
    count += 1
```

### 循环控制语句

Python提供了控制循环执行的语句：

#### break语句

`break`语句用于提前退出循环：

```python
for i in range(10):
    if i == 5:
        break
    print(i)  # 只打印0到4
```

#### continue语句

`continue`语句用于跳过当前循环的剩余部分，直接进入下一次循环：

```python
for i in range(10):
    if i % 2 == 0:
        continue
    print(i)  # 只打印奇数
```

#### else子句

Python中的循环可以带有`else`子句，当循环正常完成（没有通过`break`语句退出）时执行：

```python
# 寻找列表中的奇数
numbers = [2, 4, 6, 8, 10]
for num in numbers:
    if num % 2 == 1:
        print("发现奇数:", num)
        break
else:
    print("没有找到奇数")  # 由于所有数都是偶数，这里会执行
```

## 综合应用

控制流语句可以结合使用，创建复杂的逻辑结构：

```python
def analyze_numbers(numbers):
    if not numbers:
        return "列表为空"
    
    even_count = 0
    odd_count = 0
    sum_total = 0
    
    for num in numbers:
        sum_total += num
        if num % 2 == 0:
            even_count += 1
        else:
            odd_count += 1
    
    avg = sum_total / len(numbers)
    
    result = f"总数: {len(numbers)}, 平均值: {avg:.2f}\n"
    result += f"偶数: {even_count}个, 奇数: {odd_count}个\n"
    
    if even_count > odd_count:
        result += "偶数更多"
    elif odd_count > even_count:
        result += "奇数更多"
    else:
        result += "偶数和奇数数量相等"
    
    return result

print(analyze_numbers([1, 2, 3, 4, 5, 6, 7, 8]))
```

## 避免复杂的控制流

虽然Python的控制流结构非常灵活，但过于复杂的嵌套和条件可能导致代码难以理解和维护。以下是一些简化控制流的建议：

1. 提取复杂的条件表达式为命名变量或函数
2. 使用早期返回减少嵌套层级
3. 将复杂逻辑分解为多个小函数
4. 使用字典映射或查找表替代长串的if-elif条件
5. 考虑使用函数式编程工具如`filter()`和`map()`

例如，将长串的if-elif条件替换为字典映射：

```python
# 使用if-elif链
def get_grade_if_chain(score):
    if score >= 90:
        return "A"
    elif score >= 80:
        return "B"
    elif score >= 70:
        return "C"
    elif score >= 60:
        return "D"
    else:
        return "F"

# 使用字典映射和bisect模块
import bisect
def get_grade_lookup(score):
    grades = {0: "F", 60: "D", 70: "C", 80: "B", 90: "A"}
    breakpoints = sorted(grades.keys())
    index = bisect.bisect(breakpoints, score) - 1
    return grades[breakpoints[index]]
```

良好的控制流结构使代码更加清晰、可读和易于维护，是编写高质量Python程序的重要组成部分。
